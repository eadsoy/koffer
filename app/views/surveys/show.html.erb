<%= render 'shared/navbar' %>

<div class="mt-navbar-height ml-3 mr-3">
  <div>
    <h1 class="text-center"><%= @survey.question %></h1>
    <div class="mb-2 mt-2 d-flex align-items-center">
      <% if @survey.user.avatar.attached? %>
        <div class="image"> <%= cl_image_tag @survey.user.avatar.key, class: "round", width: "60", height: "60" %> </div>
      <% end %>
      <h5>By <%= link_to @survey.user.username, user_path(@survey.user), :class => 'link-text' %>, about <%= link_to @survey.city.title, city_path(@survey.city), :class => 'link-text' %>, posted at <%= @survey.created_at %></h5>
    </div>
  </div>
  <div class="d-flex">
    <!-- responses -->
    <div class="survey-response-container scrollable-container col-6">
      <div class="scrollable">
      <ul class="list-group mr-2">
        <% @survey.responses.each do |response| %>
          <div class="response mb-2 mt-2">
            <div class="list-group-item-nonflex mb-1 mt-1 speech-bubble">
              <h4 class="p-2"><%= response.content %></h4>
            </div>
            <div class="mb-2 mt-2 align-items-center d-flex">
              <% if response.user.avatar.attached? %>
                <div class="image"> <%= cl_image_tag response.user.avatar.key, class: "round", width: "50", height: "50" %> </div>
              <% end %>
              <h6>By <%= link_to response.user.username, user_path(response.user), :class => 'link-text' %>, at <%= response.created_at %></h6>
            </div>
          </div>
        <% end %>
      </ul>
      </div>    
    </div>
    <!-- response form container -->
    <div class="col-6">
      <div class="response-form mt-15 p-2">
        <h3 class="text-center">Post a response</h3>
        <%= simple_form_for [@survey, @response] do |f| %>
          <div class="form-inputs" id="rev-city">
            <%= f.input :content,
                        as: :text,
                        label: false %>
              <%= f.submit 'Send a response', class: 'btn btn-warning btn-block', id: "user-btn"%>
            <% end %>
          </div>
      </div>    
    </div>
  </div>
</div>
